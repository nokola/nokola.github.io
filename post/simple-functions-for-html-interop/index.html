<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>You Had Me At &#39;Hello World&#39;  | Simple Functions for HTML Interop</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.31.1" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    <link href='https://nokola.github.io/dist/main.css' rel='stylesheet' type="text/css" />
    
      
    

    

    <meta property="og:title" content="Simple Functions for HTML Interop" />
<meta property="og:description" content="I used the below functions on several occasions to transfer data between a server and Silverilght application.
The blog integration between .NET Blog Engine and my Silverlight navigation on top of this site is done using this method.
You can see the blog title &ldquo;You Had Me At Hello World&rdquo; in the Silverlighg navigation window on top.
The interop is easy and I tried it in IE, Firefox, Chrome, Opera. Define an HTML like this:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nokola.github.io/post/simple-functions-for-html-interop/" />



<meta property="article:published_time" content="2010-04-03T02:45:00&#43;00:00"/>

<meta property="article:modified_time" content="2010-04-03T02:45:00&#43;00:00"/>











<meta itemprop="name" content="Simple Functions for HTML Interop">
<meta itemprop="description" content="I used the below functions on several occasions to transfer data between a server and Silverilght application.
The blog integration between .NET Blog Engine and my Silverlight navigation on top of this site is done using this method.
You can see the blog title &ldquo;You Had Me At Hello World&rdquo; in the Silverlighg navigation window on top.
The interop is easy and I tried it in IE, Firefox, Chrome, Opera. Define an HTML like this:">


<meta itemprop="datePublished" content="2010-04-03T02:45:00&#43;00:00" />
<meta itemprop="dateModified" content="2010-04-03T02:45:00&#43;00:00" />
<meta itemprop="wordCount" content="375">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Simple Functions for HTML Interop"/>
<meta name="twitter:description" content="I used the below functions on several occasions to transfer data between a server and Silverilght application.
The blog integration between .NET Blog Engine and my Silverlight navigation on top of this site is done using this method.
You can see the blog title &ldquo;You Had Me At Hello World&rdquo; in the Silverlighg navigation window on top.
The interop is easy and I tried it in IE, Firefox, Chrome, Opera. Define an HTML like this:"/>

  </head>

  <body class="ma0 body-font bg-white">
    <style>
      .shadow-bottom {
        -webkit-box-shadow: 0px 0px 15px 0px rgba(175, 175, 175, 1);
        -moz-box-shadow:    0px 0px 15px 0px rgba(175, 175, 175, 1);
        box-shadow:         0px 0px 15px 0px rgba(175, 175, 175, 1);
      }
      .pad-2 {
        padding: 2px 0;
      }
      .sub-space {
        letter-spacing: 0.4px;
      }
      .nested-img img {
        width: initial;
        height: auto;
      }
      a {
        color: #0066ff;
      }
      pre {
        overflow: auto;
        background-color: #e1e1e1;
      }
      a.linkunder {
        text-decoration: none;
      }
      a:hover h1, a.linkunder:hover {
        text-decoration: underline;
        text-decoration-skip: ink;
      }
      .word-wrap {
        word-wrap: break-word;
      }
      .lh-copy {
        line-height: 1.42857143;
      }
      .title-font {
        font-weight: 400;
      }
      .body-font {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
    </style>
    



  
  
    <header class="cover bg-top bg-left shadow-bottom" style="background-image: url('https://nokola.github.io/header/tree1.jpg');">
  
    <div>
      
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-center items-center center">
    <section class="w-100 mw7">
      <a href="https://nokola.github.io/" class="f5 fw4 hover-white no-underline white-90 dib">
        You Had Me At &#39;Hello World&#39;
        <div class="f7 white-70 pad-2 sub-space">Design, coding, and special effects</div>
      </a>
      <div class="flex-l items-center">
        
        








      </div>
    </section>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7 ph3 pt2 ph4-ns" role="main">
      
<div class="flex-l mt2 mw7 center">
  <div>
    <article class="center cf pt2 pb1 mw7 word-wrap">
        <h1 class="f4 mt0 title-font">
        Simple Functions for HTML Interop
        </h1>
        <time class="f7 pb1 dib mid-gray normal" datetime="2010-04-03T02:45:00Z">
          2010, Apr 3
        </time>

        
        
      <section class="nested-copy-line-height lh-copy f6 nested-links nested-img dark-gray">
        <p>I used the below functions on several occasions to transfer data between a server and Silverilght application.</p>
<p>The blog integration between .NET Blog Engine and my Silverlight navigation on top of this site is done using this method.</p>
<p>You can see the blog title &ldquo;You Had Me At Hello World&rdquo; in the Silverlighg navigation window on top.</p>
<p>The interop is easy and I tried it in IE, Firefox, Chrome, Opera. Define an HTML like this:</p>
<p>[code:html]&lt;span style="visibility: hidden; display: none; height: 0px; width: 0px; border: 0px"&gt;</p>
<p><br />&nbsp;&nbsp;&nbsp; &lt;span id="titleText"&gt;You Had Me At 'Hello World!'&lt;/span&gt;</p>
<p><br />&nbsp;&nbsp;&nbsp; &lt;span id="titleLink"&gt;<a href="http://nokola.com/blog/">http://nokola.com/blog/</a>&lt;/span&gt;</p>
<p><br />&nbsp;&nbsp;&nbsp; &lt;span id="titleDescription"&gt;Coding and Special Effects for Silverlight&lt;/span&gt;</p>
<p>&lt;/span&gt;</p>
<p>[/code]</p>
<p>And then use the functions from within your Silverlight app like this:</p>
<p>[code:c#]HtmlDocument doc = HtmlPage.Document; <br />string str = doc.GetTextFromHtmlPage("titleText", "nokola.com"); <br />string uriString = doc.GetTextFromHtmlPage("titleLink", "<a href="http://nokola.com&quot;);">http://nokola.com");</a> <br />string str3 = doc.GetTextFromHtmlPage("titleDescription", null);[/code]</p>
<p>Nothing fancy, but works :)</p>
<p>Here&rsquo;s the source:</p>
<p>[code:c#]using System.Windows.Browser;</p>
<p>namespace EasyPainter <br />{ <br />&nbsp;&nbsp;&nbsp; /// &lt;summary&gt; <br />&nbsp;&nbsp;&nbsp; /// Common functions for HTML interop <br />&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;</p>
<p>&nbsp;&nbsp;&nbsp; public static class HtmlDocumentExtensions <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Retrieves the text contents of a given HTML element by ID <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Sample html: <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp; &lt;span style="visibility: hidden; display: none; height: 0px; width: 0px; border: 0px"&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span id="titleText"&gt;You Had Me At 'Hello World!'&lt;/span&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ///&nbsp;&nbsp;&nbsp; &lt;/span&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="doc"&gt;&lt;/param&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="elementId"&gt;&lt;/param&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static string GetTextFromHtmlPage(this HtmlDocument doc, string elementId) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HtmlElement elementById = doc.GetElementById(elementId); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (elementById != null) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object property = elementById.GetProperty("innerText"); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (property != null) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return property.ToString(); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; property = elementById.GetProperty("textContent"); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (property != null) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return property.ToString(); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Retrieves the text contenst of HTML element by ID with a default value <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// in case the element is missing or empty <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="doc"&gt;&lt;/param&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="elementId"&gt;&lt;/param&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="defaultValue"&gt;&lt;/param&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static string GetTextFromHtmlPage(this HtmlDocument doc, string elementId, string defaultValue) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string textFromHtmlPage = doc.GetTextFromHtmlPage(elementId); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (string.IsNullOrEmpty(textFromHtmlPage)) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return defaultValue; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return textFromHtmlPage; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp; }</p>
<p>}[/code]</p>

      </section>
      


      <div class="mt5"></div>
      
<div id="graphcomment"></div>
<script type="text/javascript">
  window.graphcomment_id = 'nokola-blog';
  (function() {
    var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
    gc.src = 'https://graphcomment.com/js/integration.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
  })();
</script>

      </article>
  </div>
</div>

    </main>
    <footer class="bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f7 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://nokola.github.io/" >
    &copy; 2017 You Had Me At &#39;Hello World&#39;
  </a>
  








  </div>
</footer>

    <script src="https://nokola.github.io/dist/app.bundle.js" async></script>

  </body>
</html>
