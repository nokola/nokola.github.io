<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>System Failure | Fantasia Lite: New Silverlight Painting Tool</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.59.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link href=https://systemfailure.io/dist/main.css rel=stylesheet type=text/css><meta property="og:title" content="Fantasia Lite: New Silverlight Painting Tool"><meta property="og:description" content="Edit: Fantasia Painter (full version), is now available here: http://fantasia.nokola.com
Edit 2: The Fantasia Lite version below, has been updated to include the new Rainbow brush (source code included too).
Here’s what I built tonight – a drawing tool that utilizes procedural brushes to enable almost everyone to create fluffy rabbits like this:
 

Note that it took me about 2 minutes to “build the rabbit”. I’m sure someone else can do better."><meta property="og:type" content="article"><meta property="og:url" content="https://systemfailure.io/post/fantasia-lite-new-silverlight-painting-tool/"><meta property="article:published_time" content="2010-07-22T13:41:06+00:00"><meta property="article:modified_time" content="2010-07-22T13:41:06+00:00"><meta itemprop=name content="Fantasia Lite: New Silverlight Painting Tool"><meta itemprop=description content="Edit: Fantasia Painter (full version), is now available here: http://fantasia.nokola.com
Edit 2: The Fantasia Lite version below, has been updated to include the new Rainbow brush (source code included too).
Here’s what I built tonight – a drawing tool that utilizes procedural brushes to enable almost everyone to create fluffy rabbits like this:
 

Note that it took me about 2 minutes to “build the rabbit”. I’m sure someone else can do better."><meta itemprop=datePublished content="2010-07-22T13:41:06&#43;00:00"><meta itemprop=dateModified content="2010-07-22T13:41:06&#43;00:00"><meta itemprop=wordCount content="714"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Fantasia Lite: New Silverlight Painting Tool"><meta name=twitter:description content="Edit: Fantasia Painter (full version), is now available here: http://fantasia.nokola.com
Edit 2: The Fantasia Lite version below, has been updated to include the new Rainbow brush (source code included too).
Here’s what I built tonight – a drawing tool that utilizes procedural brushes to enable almost everyone to create fluffy rabbits like this:
 

Note that it took me about 2 minutes to “build the rabbit”. I’m sure someone else can do better."></head><body class="ma0 body-font"><style>.shadow-bottom{-webkit-box-shadow:0 0 15px 0 #afafaf;-moz-box-shadow:0 0 15px 0 #afafaf;box-shadow:0 0 15px 0 #afafaf}.pad-2{padding:2px 0}.sub-space{display:block;font-size:20px;font-weight:400;padding-top:10px}.nested-img img{width:initial;height:auto}a{color:#06f}pre{overflow:auto;color:#ddd;white-space:pre;border:1px solid #41a85f;border-left:none;border-right:none;hyphens:none;position:relative;border-radius:2px;margin-left:-32px;margin-right:-32px;padding:0 16px;box-shadow:0 2px 14px 0 #0b0107}a{text-decoration:none}a:hover{text-decoration:underline}.word-wrap{word-wrap:break-word}.lh-copy{line-height:1.42857143}.title-font{font-weight:700;color:#cecece}.body-font{font-family:Georgia,times new roman,Times,serif}.mw6{max-width:36rem}.mt3and5{margin-top:1.5rem}article{border-radius:4px 4px}body{background:#2f3031;color:#eee}.main-link{display:block;color:inherit}.main-link:hover{text-decoration:none}.summary-article:hover{box-shadow:0 0 12px 7px rgba(0,0,0,.12)}article img{display:block}.nested-links a{color:#54acd2;font-variant:small-caps;letter-spacing:.8px}.top-link:hover{background:#464646;border-radius:4px;text-decoration:none}.gradient-top{background:#020024;background:linear-gradient(90deg,rgb(121,66,0) 0%,rgb(107,74,0) 35%,rgb(57,42,0) 100%);height:4px;border-radius:4px 4px 0 0}.gradient-top.single,.summary-article:hover .gradient-top{background:linear-gradient(90deg,rgb(19,99,3) 0%,rgb(16,68,52) 35%,rgb(32,45,31) 100%)}.utterances{margin-left:0}.f5{font-size:18px}</style><header class="mb5 cover bg-top bg-left shadow-bottom" style=background-image:url(https://systemfailure.io/header/tree1.jpg)><div><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l items-center center"><section class="w-100 mw8 center"><a href=https://systemfailure.io/ class="top-link pa3 f5 fw4 hover-white no-underline white-90 dib">System Failure<div class="f7 white-70 pad-2 sub-space">Nokola&#39;s handwritten blog on software and humans.</div></a><div class="flex-l items-center"></div></section></div></nav></div></header><main class="pb7 ph0 ph4-ns ph0-m" role=main><div class="flex-l mt2 mw8 center"><div><article class="center cf word-wrap"><div class="gradient-top single"></div><h1 class="f3 title-font ph4-ns ph3 pt3 mt3">Fantasia Lite: New Silverlight Painting Tool</h1><div class="ph4-ns mw8 ph3 pb2"><p class="f7 pt1 pb3 silver"><span>Jul 22, 2010</span></p><section class="nested-copy-line-height lh-copy f5 nested-links nested-img light-gray"><p><strong>Edit</strong>: Fantasia Painter (full version), is now available here: <a href=http://fantasia.nokola.com>http://fantasia.nokola.com</a></p><p><strong>Edit 2</strong>: The Fantasia Lite version below, has been updated to include the new Rainbow brush (source code included too).</p><p>Here’s what I built tonight – a drawing tool that utilizes procedural brushes to enable almost everyone to create fluffy rabbits like this:</p><p><a href=/rabbit.png><img style=border-right-width:0;display:inline;border-top-width:0;border-bottom-width:0;border-left-width:0 title=rabbit border=0 alt=rabbit src=/rabbit_thumb.png width=540 height=253></a></p><p></p><p></p><p>Note that it took me about 2 minutes to “build the rabbit”. I’m sure someone else can do better. Supposedly, it lives in the hole on the right.</p><p>Here’s the live app:</p><iframe style="border-bottom:0 solid;border-left:0 solid;border-top:0 solid;border-right:0 solid" height=640 src="/sample.aspx?xap=ProceduralBrush" frameborder=0 width=900></iframe><p>As usual: <a href=http://nokola.com/sources/ProceduralBrush.zip>Download source code</a></p><p>Note that this whole thing is inspired by <a title=http://mrdoob.com/120/Harmony href=http://mrdoob.com/120/Harmony>http://mrdoob.com/120/Harmony</a> (HTML5 – doesn’t work in IE8 as I write this) which was originally inspired by <a title=http://www.zefrank.com/scribbler/gallery/index_ran.html href=http://www.zefrank.com/scribbler/gallery/index_ran.html>http://www.zefrank.com/scribbler/gallery/index_ran.html</a>. By the way, make sure to check the funny videos “How To Dance Properly” on Ze’s page: <a title=http://www.zefrank.com/invite/swfs/index2.html href=http://www.zefrank.com/invite/swfs/index2.html>http://www.zefrank.com/invite/swfs/index2.html</a></p><p>I talked way back (March or something) with Mr. Doob and he released his Harmony code under the MIT license. His latest source code is now released under GPL though. I didn’t look at it since I wanted my sources to be MS-PL license-able.</p><h2>What Is A Procedural Brush?</h2><p>A typical “brush” will just draw whatever it is supposed to draw (e.g. connect dots with lines). It just needs the current and previous mouse position.</p><p>A procedural brush is “smarter”, since it takes more variables into account.</p><p>Fantasia’s brushes make use of the following data to modify the drawing output:</p><ul><li>mouse position</li><li>velocity (how fast the mouse moved)</li><li>time between 2 consecutive dots</li><li>distance between dots</li><li>slope (angle) of the line between the last and current dot</li><li>the last N previous dots (N varies between 2 and 100000)</li></ul><p>The Fantasia brushes modify these outputs:</p><ul><li>Color (e.g. color can be changed based on angle which can produce cool output – I haven’t published this brush yet)</li><li>Opacity (the faster you move, the less visible the trace is, such as in the OldPen sample</li><li>Stroke width (again can be controlled by speed, or maybe by slope (angle), which produces a nice caligraphy effect)</li><li>Drawing other random lines</li></ul><p>Here is the source code of few of the brushes:</p><p>The Line Brush – same as a “regular” brush, just connects dots with straight lines:</p><p>public override void Stroke(double x, double y, double dx, double dy, double timeMsec, double distance)<br>{<br>&#160;&#160;&#160; _surface.Render(new Line() { X1 = _prevX, Y1 = _prevY, X2 = x, Y2 = y, Stroke = _brush }, null);<br>}</p><p>The Old Pen brush, uses velocity = distance / time, to modify the color intensity:</p><p>public override void Stroke(double x, double y, double dx, double dy, double timeMsec, double distance)<br>{<br>&#160;&#160;&#160; _surface.Render(new Line()<br>&#160;&#160;&#160; {<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; X1 = _prevX,<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Y1 = _prevY,<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; X2 = x,<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Y2 = y,<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Stroke = new SolidColorBrush(<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; new Color()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; A = (byte)(255 - distance / timeMsec * 100),<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; R = (byte) (_color.R * (distance / timeMsec * 100)),<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; G = (byte) (_color.G * (distance / timeMsec * 100)),<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; B = (byte) (_color.B * (distance / timeMsec * 100)),<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; })<br>&#160;&#160;&#160; }, null);<br>}</p><p>The History brush, most complex so far and used for the sketch and Furs:</p><p>public override void Stroke(double x, double y, double dx, double dy, double timeMsec, double distance)<br>{<br>&#160;&#160;&#160; _points.Add(new Point(x, y));<br>&#160;&#160;&#160; if ((Memory &gt; 0) &amp;&amp; (_points.Count &gt; Memory)) _points.RemoveAt(0);</p><p>&#160;&#160;&#160; _surface.Render(new Line() { X1 = _prevX, Y1 = _prevY, X2 = x, Y2 = y, Stroke = _solidBrush }, null);</p><p>&#160;&#160;&#160; foreach (Point p in _points)<br>&#160;&#160;&#160; {<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; double cdx = p.X - x;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; double cdy = p.Y - y;</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; double dist2 = cdx * cdx + cdy * cdy;</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; if ((dist2 &lt; _activationDistance2) &amp;&amp; (_random.NextDouble() &gt; (dist2 / (_activationDistance2 * ActivationChance))))<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _surface.Render(new Line() { X1 = x + cdx * ReachSource, Y1 = y + cdy * ReachSource, X2 = p.X - cdx * ReachDest, Y2 = p.Y - cdy * ReachDest, Stroke = _stroke }, null);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br>&#160;&#160;&#160; }<br>}</p><p>The history brush can also do internal highlights if the _stroke is set to a LinearGradientBrush.</p><p>There is also a prototyping Test brush: I’m trying to “smoothen” the line as it is getting drawn. It’s using binaries by Charlez Petzold: <a title=http://www.charlespetzold.com/blog/2009/01/Canonical-Splines-in-WPF-and-Silverlight.html href=http://www.charlespetzold.com/blog/2009/01/Canonical-Splines-in-WPF-and-Silverlight.html>http://www.charlespetzold.com/blog/2009/01/Canonical-Splines-in-WPF-and-Silverlight.html</a></p><p>Hope you like it! Please comment!</p></section><div class=mt5></div><script src=https://utteranc.es/client.js repo=nokola/blog issue-term=pathname label=comment theme=github-dark crossorigin=anonymous async></script></div></article></div></div></main><footer class="bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f7 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://systemfailure.io/>&copy; 2020 System Failure</a></div></footer><script src=https://systemfailure.io/dist/app.bundle.js async></script></body></html>