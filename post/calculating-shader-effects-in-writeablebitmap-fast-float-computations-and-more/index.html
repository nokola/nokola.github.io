<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>System Failure | Calculating Shader Effects in WriteableBitmap (Fast Float Computations And More)</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.59.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link href=https://systemfailure.io/dist/main.css rel=stylesheet type=text/css><meta property="og:title" content="Calculating Shader Effects in WriteableBitmap (Fast Float Computations And More)"><meta property="og:description" content="Here's a small code snippet that allows you to calculate any pixel shader and get the output into a WriteableBitmap!
[code:c#]
Stream stream = Application.GetResourceStream(new Uri(&#34;SilverlightApplication1;component/Images/test.jpg&#34;, UriKind.Relative)).Stream;
WriteableBitmap result = new WriteableBitmap(1, 1); // avoid creating intermediate BitmapImage
result.SetSource(stream);
Image image = new Image();
image.Effect = new BlurEffect(); // any pixel shader effect
image.Source = result; // set the image to the original
result.Render(image, null);
result.Invalidate(); // render the pixel shader"><meta property="og:type" content="article"><meta property="og:url" content="https://systemfailure.io/post/calculating-shader-effects-in-writeablebitmap-fast-float-computations-and-more/"><meta property="article:published_time" content="2010-01-11T09:27:00+00:00"><meta property="article:modified_time" content="2010-01-11T09:27:00+00:00"><meta itemprop=name content="Calculating Shader Effects in WriteableBitmap (Fast Float Computations And More)"><meta itemprop=description content="Here's a small code snippet that allows you to calculate any pixel shader and get the output into a WriteableBitmap!
[code:c#]
Stream stream = Application.GetResourceStream(new Uri(&#34;SilverlightApplication1;component/Images/test.jpg&#34;, UriKind.Relative)).Stream;
WriteableBitmap result = new WriteableBitmap(1, 1); // avoid creating intermediate BitmapImage
result.SetSource(stream);
Image image = new Image();
image.Effect = new BlurEffect(); // any pixel shader effect
image.Source = result; // set the image to the original
result.Render(image, null);
result.Invalidate(); // render the pixel shader"><meta itemprop=datePublished content="2010-01-11T09:27:00&#43;00:00"><meta itemprop=dateModified content="2010-01-11T09:27:00&#43;00:00"><meta itemprop=wordCount content="256"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Calculating Shader Effects in WriteableBitmap (Fast Float Computations And More)"><meta name=twitter:description content="Here's a small code snippet that allows you to calculate any pixel shader and get the output into a WriteableBitmap!
[code:c#]
Stream stream = Application.GetResourceStream(new Uri(&#34;SilverlightApplication1;component/Images/test.jpg&#34;, UriKind.Relative)).Stream;
WriteableBitmap result = new WriteableBitmap(1, 1); // avoid creating intermediate BitmapImage
result.SetSource(stream);
Image image = new Image();
image.Effect = new BlurEffect(); // any pixel shader effect
image.Source = result; // set the image to the original
result.Render(image, null);
result.Invalidate(); // render the pixel shader"></head><body class="ma0 body-font"><style>.shadow-bottom{-webkit-box-shadow:0 0 15px 0 #afafaf;-moz-box-shadow:0 0 15px 0 #afafaf;box-shadow:0 0 15px 0 #afafaf}.pad-2{padding:2px 0}.sub-space{display:block;font-size:20px;font-weight:400;padding-top:10px}.nested-img img{width:initial;height:auto}a{color:#06f}pre{overflow:auto;color:#ddd;white-space:pre;border:1px solid #41a85f;border-left:none;border-right:none;hyphens:none;position:relative;border-radius:2px;margin-left:-32px;margin-right:-32px;padding:0 16px;box-shadow:0 2px 14px 0 #0b0107}a{text-decoration:none}a:hover{text-decoration:underline}.word-wrap{word-wrap:break-word}.lh-copy{line-height:1.42857143}.title-font{font-weight:700;color:#cecece}.body-font{font-family:segoe ui,Tahoma,Geneva,Verdana,sans-serif}.mw6{max-width:36rem}.mt3and5{margin-top:1.5rem}article{background:#1b1b1b;border-radius:4px 4px}body{background:#2f3031;color:#eee}.main-link{display:block;color:inherit}.main-link:hover{text-decoration:none}.summary-article:hover{box-shadow:0 0 12px 7px rgba(0,0,0,.12)}article img{display:block}.nested-links a{color:#54acd2;font-variant:small-caps;letter-spacing:.8px}.top-link:hover{background:#464646;border-radius:4px;text-decoration:none}.gradient-top{background:#020024;background:linear-gradient(90deg,rgb(121,66,0) 0%,rgb(107,74,0) 35%,rgb(57,42,0) 100%);height:4px;border-radius:4px 4px 0 0}.gradient-top.single,.summary-article:hover .gradient-top{background:linear-gradient(90deg,rgb(19,99,3) 0%,rgb(16,68,52) 35%,rgb(32,45,31) 100%)}.utterances{margin-left:0}</style><header class="mb5 cover bg-top bg-left shadow-bottom" style=background-image:url(https://systemfailure.io/header/tree1.jpg)><div><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l items-center center"><section class="w-100 mw8 center"><a href=https://systemfailure.io/ class="top-link pa3 f5 fw4 hover-white no-underline white-90 dib">System Failure<div class="f7 white-70 pad-2 sub-space">Nokola&#39;s handwritten blog on software and humans.</div></a><div class="flex-l items-center"></div></section></div></nav></div></header><main class="pb7 ph0 ph4-ns ph0-m" role=main><div class="flex-l mt2 mw8 center"><div><article class="center cf word-wrap"><div class="gradient-top single"></div><h1 class="f3 title-font ph4-ns ph3 pt3 mt3">Calculating Shader Effects in WriteableBitmap (Fast Float Computations And More)</h1><div class="ph4-ns mw8 ph3 pb2"><p class="f7 pt1 pb3 silver"><span>Jan 11, 2010</span></p><section class="nested-copy-line-height lh-copy f5 nested-links nested-img light-gray"><p>Here's a small code snippet that allows you to calculate any pixel shader and get the output into a WriteableBitmap!</p><p>[code:c#]</p><p>Stream stream = Application.GetResourceStream(new Uri("SilverlightApplication1;component/Images/test.jpg", UriKind.Relative)).Stream;<br>WriteableBitmap result = new WriteableBitmap(1, 1); // avoid creating intermediate BitmapImage<br>result.SetSource(stream);</p><p>Image image = new Image();<br>image.Effect = new BlurEffect(); // any pixel shader effect<br>image.Source = result; // set the image to the original<br>result.Render(image, null);<br>result.Invalidate(); // render the pixel shader<br>image.Source = null; // release the bitmap reference<br>image.Effect = null;<br>GC.Collect(); // remove all obsolete bitmaps from memory [optional]<br>// result contains the image with shader effect applied! assign it to any Image.Source!<br>myImage.Source = result;<br>[/code]</p><p>For the sample, I used InvertColorEffect() that I had on my PC, but you could try with your own (or just use the BlurEffect() to see how it works).</p><p>Note that the image doesn't even have to be part of the UI tree, and you don't have to wait for a render pass!</p><h2>Why is this good?</h2><p>In an apples-to-apples comparison (float computations) pixel shaders are much faster than managed code. See <a href=http://kodierer.blogspot.com/2009/08/silverlight-3-writeablebitmap.html>http://kodierer.blogspot.com/2009/08/silverlight-3-writeablebitmap.html</a>&nbsp;for performance comparison. This means that you can now run even faster computations from managed code in Silverlight!</p><p>Also in case Silverlight eventually executes shaders on the GPU (I don't know what is the plan about that), your applications will really be able to benefit from the fast computations!</p><p>There is also one other reason why is it so good: but I'll mention it in a later post (working on secret project now...) :)</p><p>&nbsp;</p></section><div class=mt5></div><script src=https://utteranc.es/client.js repo=nokola/blog issue-term=pathname label=comment theme=github-dark crossorigin=anonymous async></script></div></article></div></div></main><footer class="bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f7 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://systemfailure.io/>&copy; 2019 System Failure</a></div></footer><script src=https://systemfailure.io/dist/app.bundle.js async></script></body></html>